{"version":3,"sources":["text-canvas.js"],"names":["global","factory","exports","module","define","amd","TextCanvas","this","_classCallCheck","instance","Constructor","TypeError","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","text","style","undefined","resolution","createCanvas","value","_canvas","document","createElement","_ctx","getContext","scale","_resolution","_style","font","fontStyle","fontVariant","fontWeight","fontSize","fontFamily","textAlign","textBaseline","fillStyle","textColor","forcedLines","_text","split","wordWrap","spaceMeasure","measureText","lines","lineHeight","currentLine","width","height","lineWords","wordMeasure","j","trim","push","maxWith","maxHeight","Math","max","ceil","applyStyles","createLines","dimensions","getCanvasDimensions","adjustment","clearRect","x","y","fillText","get","set","constructor","name","RangeError","defaultTextStyle","Number","isNaN","window","devicePixelRatio","parseFloat","sign"],"mappings":"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","file":"text-canvas.min.js","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.TextCanvas = factory());\n}(this, (function () { 'use strict';\n\n/**\n * @name TextCanas\n * @desc Renders wrapped text to a 2D canvas element.\n * @author Luis Rodrigues (http://www.luisrodriguesweb.com)\n * @version 0.1.0-alpha\n * @license MIT\n */\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TextCanvas = function () {\n  function TextCanvas(text) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var resolution = arguments[2];\n\n    _classCallCheck(this, TextCanvas);\n\n    this.text = text;\n    this.style = style;\n    this.resolution = resolution;\n\n    this.createCanvas();\n  }\n\n  _createClass(TextCanvas, [{\n    key: 'createCanvas',\n    value: function createCanvas() {\n      this._canvas = document.createElement('canvas');\n      this._ctx = this._canvas.getContext('2d');\n\n      return this._canvas;\n    }\n  }, {\n    key: 'applyStyles',\n    value: function applyStyles() {\n      this._ctx.scale(this._resolution, this._resolution);\n\n      var style = this._style;\n\n      this._ctx.font = style.fontStyle + ' ' + style.fontVariant + ' ' + style.fontWeight + ' ' + style.fontSize + 'px ' + style.fontFamily;\n      this._ctx.textAlign = style.textAlign;\n      this._ctx.textBaseline = style.textBaseline;\n      this._ctx.fillStyle = style.textColor;\n    }\n  }, {\n    key: 'createLines',\n    value: function createLines() {\n      var forcedLines = this._text.split('\\n');\n\n      if (!this._style.wordWrap) {\n        return forcedLines;\n      }\n\n      var spaceMeasure = this._ctx.measureText(' ');\n      var lines = [];\n      var lineHeight = this._style.lineHeight || this._style.fontSize * 1.2;\n      var currentLine = {\n        text: '',\n        width: 0,\n        height: lineHeight\n      };\n      var lineWords = void 0;\n      var wordMeasure = void 0;\n\n      for (var i = 0; i < forcedLines.length; i++) {\n        lineWords = forcedLines[i].split(' ');\n\n        for (var j = 0; j < lineWords.length; j++) {\n          wordMeasure = this._ctx.measureText(lineWords[j]);\n\n          if (currentLine.width + wordMeasure.width > this._style.wordWrap) {\n            if (j && i) {\n              currentLine.text = currentLine.text.trim();\n              currentLine.width -= spaceMeasure.width;\n\n              lines.push(currentLine);\n\n              currentLine = {\n                text: '',\n                width: 0,\n                height: lineHeight\n              };\n            }\n\n            currentLine.width = wordMeasure.width + spaceMeasure.width;\n            currentLine.text = lineWords[j] + ' ';\n          } else {\n            currentLine.width += wordMeasure.width + spaceMeasure.width;\n            currentLine.text += lineWords[j] + ' ';\n          }\n        }\n\n        currentLine.text = currentLine.text.trim();\n        currentLine.width -= spaceMeasure.width;\n\n        lines.push(currentLine);\n\n        currentLine = {\n          text: '',\n          width: 0,\n          height: lineHeight\n        };\n      }\n\n      return lines;\n    }\n  }, {\n    key: 'getCanvasDimensions',\n    value: function getCanvasDimensions(lines) {\n      var maxWith = 0;\n      var maxHeight = 0;\n\n      for (var i = 0; i < lines.length; i++) {\n        maxWith = Math.max(maxWith, lines[i].width);\n        maxHeight += lines[i].height;\n      }\n\n      return {\n        width: Math.ceil(maxWith),\n        height: Math.ceil(maxHeight)\n      };\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      this.applyStyles();\n\n      var lines = this.createLines();\n      var dimensions = this.getCanvasDimensions(lines);\n\n      this._canvas.width = (dimensions.width + dimensions.adjustment) * this._resolution;\n      this._canvas.height = (dimensions.height + dimensions.adjustment) * this._resolution;\n\n      this.applyStyles();\n\n      this._ctx.clearRect(0, 0, dimensions.width, dimensions.height);\n\n      var x = 0;\n      var y = 0;\n\n      if (this._style.textAlign === 'center') {\n        x = dimensions.width / 2;\n      } else if (this._style.textAlign === 'right') {\n        x = dimensions.width;\n      }\n\n      for (var i = 0; i < lines.length; i++) {\n        y += lines[i].height;\n        this._ctx.fillText(lines[i].text, x, y);\n      }\n\n      return this._canvas;\n    }\n  }, {\n    key: 'defaultTextStyle',\n    get: function get() {\n      return {\n        fontFamily: 'sans-serif',\n        fontStyle: 'normal',\n        fontWeight: 'normal',\n        fontVariant: 'normal',\n        fontSize: 16,\n        textAlign: 'left',\n        textBaseline: 'bottom',\n        textColor: 'black',\n        wordWrap: false\n      };\n    }\n  }, {\n    key: 'text',\n    get: function get() {\n      return this._text;\n    },\n    set: function set(value) {\n      if (typeof value !== 'string') {\n        throw new TypeError(this.constructor.name + ': \\'text\\' must be a string.');\n      }\n\n      value = value.trim();\n\n      if (!value) {\n        throw new RangeError(this.constructor.name + ': \\'text\\' is empty.');\n      }\n\n      this._text = value;\n      return this._text;\n    }\n  }, {\n    key: 'style',\n    get: function get() {\n      return this._style;\n    },\n    set: function set() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      this._style = _extends({}, this.defaultTextStyle, value);\n\n      return this._style;\n    }\n  }, {\n    key: 'resolution',\n    get: function get() {\n      return this._resolution;\n    },\n    set: function set(value) {\n      if (value !== void 0 && Number.isNaN(value)) {\n        throw new TypeError(this.constructor.name + ': \\'resolution\\' must be a number.');\n      }\n\n      if (value === 0) {\n        throw new RangeError(this.constructor.name + ': \\'resolution\\' must be greater than 0.');\n      }\n\n      value = value || window.devicePixelRatio || 1;\n      value = parseFloat(value);\n\n      if (Math.sign(value) === -1) {\n        throw new RangeError(this.constructor.name + ': \\'resolution\\' must be a positive number.');\n      }\n\n      this._resolution = value;\n\n      return this._resolution;\n    }\n  }]);\n\n  return TextCanvas;\n}();\n\nreturn TextCanvas;\n\n})));\n//# sourceMappingURL=text-canvas.js.map\n"]}